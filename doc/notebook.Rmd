---
title: "R Notebook"
output: html_notebook
---

```{r}
rm(list = ls())
library(tidyverse)
library(ggplot2)
library(lmtest)
library(Hmisc)
```

```{r}
rm(list = ls())
df = read.table("../data/houseprices.txt", header = TRUE, sep = "\t")
df$Fireplace <- as.factor(df$Fireplace)
summary(df)

df_logs = df
df_logs$Acres = log10(df_logs$Acres + 1)
df_logs$Age = log10(df_logs$Age + 1)
summary(df_logs)

```

```{r fig.height=20, fig.width=30}
plot(df)
plot(df_logs)
rcorr(as.matrix(df), type = c("pearson","spearman"))
df_logs.matrix = as.matrix(df_logs)
rcorr(df_logs.matrix, type = c("pearson","spearman"))
```

```{r fig.height=7, fig.width=10}
plot(df$Size, df$Price, xlab="Area (square ft)", ylab="Price ($ ,000)", main="Price by Size")
plot(df$Baths, df$Price, xlab="# of Baths", ylab="Price ($ ,000)", main="Price by Baths")
plot(df$Bedrooms, df$Price, xlab="# of Bedrooms", ylab="Price ($ ,000)", main="Price by Bedrooms")
plot(df$Fireplace, df$Price, xlab="has fireplace", ylab="Price ($ ,000)", main="Price by Fireplace")
plot(df$Acres, df$Price, xlab="log(Acres)", ylab="Price ($ ,000)", main="Price by Acres")
plot(df$Age, df$Price, xlab="Age (Years)", ylab="Price ($ ,000)", main="Price by Age")
     
plot(df_logs$Acres, df_logs$Price, xlab="log(Acres)", ylab="Price ($ ,000)", main="Price by log(Acres)")
plot(df_logs$Age, df_logs$Price, xlab="log(Age) (Years)", ylab="Price ($ ,000)", main="Price by log(Age)")
```

```{r}
df.full_lm <- lm(Price ~ ., data = df_logs)
df.full_res = lm(log(Price) ~ ., data = df_logs)
summary(df.full_lm)
summary(df.full_res)



                # the horizon
```

```{r fig.height=5, fig.width=8}
# log of response
plot(df.full_lm)
plot(df.full_res)
```

```{r}
# whites test
bptest(df.full_lm, ~ disp*hp*am + I(disp^2) + I(hp^2)+ I(am^2), data = mtcars)
```
